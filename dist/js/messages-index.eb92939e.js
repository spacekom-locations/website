"use strict";(self["webpackChunkwebsite"]=self["webpackChunkwebsite"]||[]).push([[37],{13099:function(t,e,s){s.d(e,{Z:function(){return h}});var a=s(96428),i=s(46952),r=s(48085),o=s(2936),n=s(36591),l=s(93536),d=s(73325),c=s(4589),h=(0,d.Z)(i.Z,(0,l.d)(["left","bottom"]),r.Z,o.Z,n.Z).extend({name:"v-badge",props:{avatar:Boolean,bordered:Boolean,color:{type:String,default:"primary"},content:{required:!1},dot:Boolean,label:{type:String,default:"$vuetify.badge"},icon:String,inline:Boolean,offsetX:[Number,String],offsetY:[Number,String],overlap:Boolean,tile:Boolean,transition:{type:String,default:"scale-rotate-transition"},value:{default:!0}},computed:{classes(){return{"v-badge--avatar":this.avatar,"v-badge--bordered":this.bordered,"v-badge--bottom":this.bottom,"v-badge--dot":this.dot,"v-badge--icon":null!=this.icon,"v-badge--inline":this.inline,"v-badge--left":this.left,"v-badge--overlap":this.overlap,"v-badge--tile":this.tile,...this.themeClasses}},computedBottom(){return this.bottom?"auto":this.computedYOffset},computedLeft(){return this.isRtl?this.left?this.computedXOffset:"auto":this.left?"auto":this.computedXOffset},computedRight(){return this.isRtl?this.left?"auto":this.computedXOffset:this.left?this.computedXOffset:"auto"},computedTop(){return this.bottom?this.computedYOffset:"auto"},computedXOffset(){return this.calcPosition(this.offsetX)},computedYOffset(){return this.calcPosition(this.offsetY)},isRtl(){return this.$vuetify.rtl},offset(){return this.overlap?this.dot?8:12:this.dot?2:4},styles(){return this.inline?{}:{bottom:this.computedBottom,left:this.computedLeft,right:this.computedRight,top:this.computedTop}}},methods:{calcPosition(t){return`calc(100% - ${(0,c.kb)(t||this.offset)})`},genBadge(){const t=this.$vuetify.lang,e=this.$attrs["aria-label"]||t.t(this.label),s=this.setBackgroundColor(this.color,{staticClass:"v-badge__badge",style:this.styles,attrs:{"aria-atomic":this.$attrs["aria-atomic"]||"true","aria-label":e,"aria-live":this.$attrs["aria-live"]||"polite",title:this.$attrs.title,role:this.$attrs.role||"status"},directives:[{name:"show",value:this.isActive}]}),a=this.$createElement("span",s,[this.genBadgeContent()]);return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[a]):a},genBadgeContent(){if(this.dot)return;const t=(0,c.z9)(this,"badge");return t||(this.content?String(this.content):this.icon?this.$createElement(a.Z,this.icon):void 0)},genBadgeWrapper(){return this.$createElement("span",{staticClass:"v-badge__wrapper"},[this.genBadge()])}},render(t){const e=[this.genBadgeWrapper()],s=[(0,c.z9)(this)],{"aria-atomic":a,"aria-label":i,"aria-live":r,role:o,title:n,...l}=this.$attrs;return this.inline&&this.left?s.unshift(e):s.push(e),t("span",{staticClass:"v-badge",attrs:l,class:this.classes},s)}})},36591:function(t,e,s){var a=s(20144);e["Z"]=a["default"].extend({name:"transitionable",props:{mode:String,origin:String,transition:String}})},61747:function(t,e,s){s.d(e,{Io:function(){return n},MW:function(){return o},bG:function(){return l},gK:function(){return r},vW:function(){return i}});var a=s(76051);const i=async function(){const t=await a.ZP.get("/messages");return t.data},r=async function(t,e,s,i){const r=await a.ZP.post("/messages",{message:t,location_id:e,booking_inputs:s,has_flexible_dates:i});return r.data},o=async function(t,e){const s=await a.ZP.post("/messages/compose-from-booking",{message:e,booking_id:t});return s.data},n=async function(t){const e=await a.ZP.get(`/messages/${t}`);return e.data},l=async function(t,e){const s=await a.ZP.post(`messages/${t}`,{message:e});return s.data}},66643:function(t,e,s){s.r(e),s.d(e,{default:function(){return P}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{class:{"pa-0 ma-0":t.threads.length>0},style:0==t.threads.length?"max-width: 1080px":"",attrs:{fluid:""}},[t.loading?s("div",{staticClass:"mt-12"},[s("v-progress-linear",{attrs:{rounded:"",indeterminate:!0,color:"success",height:"25"}})],1):t._e(),0==t.threads.length&&0==t.loading?s("v-card",{staticClass:"pa-8 grey--text",attrs:{outlined:""}},[s("v-card-title",[s("v-spacer"),t._v(" You have no inbox messages "),s("v-spacer")],1)],1):t._e(),t.threads.length>0?s("div",[s("v-container",{staticClass:"pos-main fill-height pa-0",staticStyle:{height:"calc(100vh - 70px)"},attrs:{fluid:""}},[s("v-row",{staticClass:"no-gutters flex-wrap flex-column fill-height"},[s("v-col",{staticClass:"grow",attrs:{cols:"auto"}},[s("v-row",{staticClass:"fill-height pa-0 ma-0"},[s("v-col",{staticClass:"pa-0 ma-0",staticStyle:{"border-right":"1px solid #d2d2d2 !important"},attrs:{cols:"3",xl:"2"}},[s("div",{staticClass:"sticky-top",staticStyle:{"z-index":"2"}},[s("v-card",{staticStyle:{"border-bottom":"1px solid #d2d2d2 !important","border-radius":"0"},attrs:{height:"70px",flat:""}},[s("v-card-title",[t._v(" threads ")])],1)],1),s("div",{staticStyle:{height:"calc(100vh - 150px)",overflow:"auto"}},[s("v-list",{staticClass:"pa-0 ma-0",attrs:{"three-line":""}},t._l(t.threads,(function(e,a){return s("div",{key:a,on:{click:function(s){return t.setSelectedThread(e)}}},[a>0?s("v-divider"):t._e(),s("v-list-item",{key:e.title+a,attrs:{route:"",to:{name:"Messages.Thread",params:{id:e.id}}}},[s("v-list-item-avatar",{attrs:{size:"65"}},[s("user-avatar",{attrs:{size:65,image:t.getThreadUser(e).avatar}})],1),s("v-list-item-content",[s("v-list-item-title",{staticClass:"font-weight-bold"},[s("v-badge",{attrs:{color:t.countThreadNewMessages(e.id)?"green":"transparent",inline:"","x-large":"",content:t.countThreadNewMessages(e.id)}},[t._v(" "+t._s(t.getThreadUser(e).name)+" ")])],1),s("v-list-item-subtitle",[t._v(" "+t._s(e.location.title)+" ")])],1)],1)],1)})),0)],1)]),s("v-col",{staticClass:"pa-0 ma-0"},[s("div",[s("router-view")],1)]),s("v-col",{staticClass:"pa-0 ma-0",staticStyle:{"border-left":"1px solid #d2d2d2 !important"},attrs:{cols:"3",xl:"2"}},[s("div",{staticClass:"sticky-top",staticStyle:{"z-index":"2"}},[s("v-card",{staticStyle:{"border-bottom":"1px solid #d2d2d2 !important","border-radius":"0"},attrs:{height:"70px",flat:""}},[s("v-card-title",[t._v(" details ")])],1),s("div",{staticClass:"pa-4",staticStyle:{height:"calc(100vh - 150px)",overflow:"auto"}},[s("location-details",{attrs:{location:t.location}})],1)],1)])],1)],1)],1)],1)],1):t._e()],1)},i=[],r=s(61747),o=s(76942),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("v-card",{attrs:{flat:"",to:{name:"Listing.Show",params:{locationId:t.location.id}}}},[s("v-img",{attrs:{"aspect-ratio":16/9,src:null==t.location.images[0]?"https://giggster.com/images/imgEmpty2.svg":t.location.images[0]}}),s("p",{staticClass:"title font-weight-bold"},[t._v(" "+t._s(t.location.title?t.location.title:"unTitled")+" ")])],1)],1),s("v-divider"),s("div",[s("v-card",{staticClass:"pa-4",attrs:{flat:""}},[s("v-row",[s("v-col",{attrs:{cols:"8"}},[s("router-link",{staticStyle:{"text-decoration":"none",color:"black"},attrs:{to:{name:"UserProfile",params:{id:t.location.user.id}}}},[s("p",{staticClass:"title font-weight-bold py-0 my-0 user-name-route"},[t._v(" "+t._s(t.location.user.name)+" ")])]),s("p",{staticClass:"subtitle-2 py-0 my-0"},[s("span",{staticClass:"grey--text"},[t._v("Response rating: ")]),s("span",[t._v("Excellent")])]),s("p",{staticClass:"subtitle-2 py-0 my-0"},[s("span",{staticClass:"grey--text"},[t._v("Response time: ")]),s("span",[t._v("A few hours")])])],1),s("v-col",{staticClass:"text-right"},[s("router-link",{staticStyle:{"text-decoration":"none",color:"black"},attrs:{to:{name:"UserProfile",params:{id:t.location.user.id}}}},[s("user-avatar",{attrs:{image:t.location.user.avatar,size:64}})],1)],1)],1)],1)],1),s("v-divider"),s("div")],1)},l=[],d={components:{UserAvatar:o.Z},props:{location:{required:!0,type:Object,default(){return{images:[],user:{}}}}}},c=d,h=s(1001),u=s(43453),g=s.n(u),p=s(53237),m=s(82102),v=s(11418),f=s(97047),b=s(62877),y=(0,h.Z)(c,n,l,!1,null,"5069c7f9",null),w=y.exports;g()(y,{VCard:p.Z,VCol:m.Z,VDivider:v.Z,VImg:f.Z,VRow:b.Z});var C=s(80394),_={components:{UserAvatar:o.Z,LocationDetails:w},data:()=>({threads:[],selectedThread:{},loading:!1,messages:[],newMessages:[],msg:null,messagesSoundURL:"https://proxy.notificationsounds.com/notification-sounds/elegant-notification-sound/download/file-sounds-1233-elegant.mp3"}),computed:{location(){return this.selectedThread.location}},async created(){await this.loadUserThreads(),this.threads.length>0&&(this.selectedThread=this.threads[0],this.$router.replace({name:"Messages.Thread",params:{id:this.threads[0].id}})),C.c.$on("new-messenger-message",this.setNewMessage)},methods:{setNewMessage(t){this.selectedThread&&this.selectedThread.id!=t.thread_id&&this.newMessages.push(t),C.c.$emit("message-for-thread-"+t.thread_id,t),this.playMessagesSound()},playMessagesSound(){var t=new Audio(this.messagesSoundURL);t.play()},countThreadNewMessages(t){let e=0;for(let s=0;s<this.newMessages.length;s++)this.newMessages[s].thread_id==t&&++e;return e},removeThreadNewMessages(t){for(let e=0;e<this.newMessages.length;e++)this.newMessages[e].thread_id==t&&this.newMessages.splice(e,1)},setSelectedThread(t){this.selectedThread=t},getThreadUser(t){return t.participants[0].user_id==this.$store.getters["User/user"].id?t.participants[1].user:t.participants[0].user},async loadUserThreads(){this.loading=!0;const t=await(0,r.vW)();this.threads=t.data,this.loading=!1}}},Z=_,x=s(13099),S=s(37118),T=s(99846),$=s(16816),V=s(97620),k=s(96421),M=s(41317),B=s(57003),L=s(99762),U=(0,h.Z)(Z,a,i,!1,null,"3776e39b",null),P=U.exports;g()(U,{VBadge:x.Z,VCard:p.Z,VCardTitle:S.EB,VCol:m.Z,VContainer:T.Z,VDivider:v.Z,VList:$.Z,VListItem:V.Z,VListItemAvatar:k.Z,VListItemContent:M.km,VListItemSubtitle:M.oZ,VListItemTitle:M.V9,VProgressLinear:B.Z,VRow:b.Z,VSpacer:L.Z})}}]);
//# sourceMappingURL=messages-index.eb92939e.js.map