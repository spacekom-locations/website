"use strict";(self["webpackChunkwebsite"]=self["webpackChunkwebsite"]||[]).push([[37],{13099:function(t,e,s){s.d(e,{Z:function(){return g}});var a=s(73274),r=s(4367),i=(s(9653),s(96428)),n=s(46952),o=s(48085),c=s(2936),l=s(36591),u=s(93536),d=s(73325),h=s(4589),p=["aria-atomic","aria-label","aria-live","role","title"],g=(0,d.Z)(n.Z,(0,u.d)(["left","bottom"]),o.Z,c.Z,l.Z).extend({name:"v-badge",props:{avatar:Boolean,bordered:Boolean,color:{type:String,default:"primary"},content:{required:!1},dot:Boolean,label:{type:String,default:"$vuetify.badge"},icon:String,inline:Boolean,offsetX:[Number,String],offsetY:[Number,String],overlap:Boolean,tile:Boolean,transition:{type:String,default:"scale-rotate-transition"},value:{default:!0}},computed:{classes:function(){return(0,r.Z)({"v-badge--avatar":this.avatar,"v-badge--bordered":this.bordered,"v-badge--bottom":this.bottom,"v-badge--dot":this.dot,"v-badge--icon":null!=this.icon,"v-badge--inline":this.inline,"v-badge--left":this.left,"v-badge--overlap":this.overlap,"v-badge--tile":this.tile},this.themeClasses)},computedBottom:function(){return this.bottom?"auto":this.computedYOffset},computedLeft:function(){return this.isRtl?this.left?this.computedXOffset:"auto":this.left?"auto":this.computedXOffset},computedRight:function(){return this.isRtl?this.left?"auto":this.computedXOffset:this.left?this.computedXOffset:"auto"},computedTop:function(){return this.bottom?this.computedYOffset:"auto"},computedXOffset:function(){return this.calcPosition(this.offsetX)},computedYOffset:function(){return this.calcPosition(this.offsetY)},isRtl:function(){return this.$vuetify.rtl},offset:function(){return this.overlap?this.dot?8:12:this.dot?2:4},styles:function(){return this.inline?{}:{bottom:this.computedBottom,left:this.computedLeft,right:this.computedRight,top:this.computedTop}}},methods:{calcPosition:function(t){return"calc(100% - ".concat((0,h.kb)(t||this.offset),")")},genBadge:function(){var t=this.$vuetify.lang,e=this.$attrs["aria-label"]||t.t(this.label),s=this.setBackgroundColor(this.color,{staticClass:"v-badge__badge",style:this.styles,attrs:{"aria-atomic":this.$attrs["aria-atomic"]||"true","aria-label":e,"aria-live":this.$attrs["aria-live"]||"polite",title:this.$attrs.title,role:this.$attrs.role||"status"},directives:[{name:"show",value:this.isActive}]}),a=this.$createElement("span",s,[this.genBadgeContent()]);return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[a]):a},genBadgeContent:function(){if(!this.dot){var t=(0,h.z9)(this,"badge");return t||(this.content?String(this.content):this.icon?this.$createElement(i.Z,this.icon):void 0)}},genBadgeWrapper:function(){return this.$createElement("span",{staticClass:"v-badge__wrapper"},[this.genBadge()])}},render:function(t){var e=[this.genBadgeWrapper()],s=[(0,h.z9)(this)],r=this.$attrs,i=(r["aria-atomic"],r["aria-label"],r["aria-live"],r.role,r.title,(0,a.Z)(r,p));return this.inline&&this.left?s.unshift(e):s.push(e),t("span",{staticClass:"v-badge",attrs:i,class:this.classes},s)}})},36591:function(t,e,s){var a=s(20144);e["Z"]=a["default"].extend({name:"transitionable",props:{mode:String,origin:String,transition:String}})},61747:function(t,e,s){s.d(e,{Io:function(){return c},MW:function(){return o},bG:function(){return l},gK:function(){return n},vW:function(){return i}});var a=s(16198),r=(s(35666),s(76051)),i=function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.ZP.get("/messages");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(e,s,a,i){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.ZP.post("/messages",{message:e,location_id:s,booking_inputs:a,has_flexible_dates:i});case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e,s,a,r){return t.apply(this,arguments)}}(),o=function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(e,s){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.ZP.post("/messages/compose-from-booking",{message:s,booking_id:e});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}(),c=function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.ZP.get("/messages/".concat(e));case 2:return s=t.sent,t.abrupt("return",s.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(e,s){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.ZP.post("messages/".concat(e),{message:s});case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},66643:function(t,e,s){s.r(e),s.d(e,{default:function(){return P}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{class:{"pa-0 ma-0":t.threads.length>0},style:0==t.threads.length?"max-width: 1080px":"",attrs:{fluid:""}},[t.loading?s("div",{staticClass:"mt-12"},[s("v-progress-linear",{attrs:{rounded:"",indeterminate:!0,color:"success",height:"25"}})],1):t._e(),0==t.threads.length&&0==t.loading?s("v-card",{staticClass:"pa-8 grey--text",attrs:{outlined:""}},[s("v-card-title",[s("v-spacer"),t._v(" You have no inbox messages "),s("v-spacer")],1)],1):t._e(),t.threads.length>0?s("div",[s("v-container",{staticClass:"pos-main fill-height pa-0",staticStyle:{height:"calc(100vh - 70px)"},attrs:{fluid:""}},[s("v-row",{staticClass:"no-gutters flex-wrap flex-column fill-height"},[s("v-col",{staticClass:"grow",attrs:{cols:"auto"}},[s("v-row",{staticClass:"fill-height pa-0 ma-0"},[s("v-col",{staticClass:"pa-0 ma-0",staticStyle:{"border-right":"1px solid #d2d2d2 !important"},attrs:{cols:"3",xl:"2"}},[s("div",{staticClass:"sticky-top",staticStyle:{"z-index":"2"}},[s("v-card",{staticStyle:{"border-bottom":"1px solid #d2d2d2 !important","border-radius":"0"},attrs:{height:"70px",flat:""}},[s("v-card-title",[t._v(" threads ")])],1)],1),s("div",{staticStyle:{height:"calc(100vh - 150px)",overflow:"auto"}},[s("v-list",{staticClass:"pa-0 ma-0",attrs:{"three-line":""}},t._l(t.threads,(function(e,a){return s("div",{key:a,on:{click:function(s){return t.setSelectedThread(e)}}},[a>0?s("v-divider"):t._e(),s("v-list-item",{key:e.title+a,attrs:{route:"",to:{name:"Messages.Thread",params:{id:e.id}}}},[s("v-list-item-avatar",{attrs:{size:"65"}},[s("user-avatar",{attrs:{size:65,image:t.getThreadUser(e).avatar}})],1),s("v-list-item-content",[s("v-list-item-title",{staticClass:"font-weight-bold"},[s("v-badge",{attrs:{color:t.countThreadNewMessages(e.id)?"green":"transparent",inline:"","x-large":"",content:t.countThreadNewMessages(e.id)}},[t._v(" "+t._s(t.getThreadUser(e).name)+" ")])],1),s("v-list-item-subtitle",[t._v(" "+t._s(e.location.title)+" ")])],1)],1)],1)})),0)],1)]),s("v-col",{staticClass:"pa-0 ma-0"},[s("div",[s("router-view")],1)]),s("v-col",{staticClass:"pa-0 ma-0",staticStyle:{"border-left":"1px solid #d2d2d2 !important"},attrs:{cols:"3",xl:"2"}},[s("div",{staticClass:"sticky-top",staticStyle:{"z-index":"2"}},[s("v-card",{staticStyle:{"border-bottom":"1px solid #d2d2d2 !important","border-radius":"0"},attrs:{height:"70px",flat:""}},[s("v-card-title",[t._v(" details ")])],1),s("div",{staticClass:"pa-4",staticStyle:{height:"calc(100vh - 150px)",overflow:"auto"}},[s("location-details",{attrs:{location:t.location}})],1)],1)])],1)],1)],1)],1)],1):t._e()],1)},r=[],i=s(16198),n=(s(35666),s(74916),s(15306),s(40561),s(61747)),o=s(76942),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("v-card",{attrs:{flat:"",to:{name:"Listing.Show",params:{locationId:t.location.id}}}},[s("v-img",{attrs:{"aspect-ratio":16/9,src:null==t.location.images[0]?"https://giggster.com/images/imgEmpty2.svg":t.location.images[0]}}),s("p",{staticClass:"title font-weight-bold"},[t._v(" "+t._s(t.location.title?t.location.title:"unTitled")+" ")])],1)],1),s("v-divider"),s("div",[s("v-card",{staticClass:"pa-4",attrs:{flat:""}},[s("v-row",[s("v-col",{attrs:{cols:"8"}},[s("router-link",{staticStyle:{"text-decoration":"none",color:"black"},attrs:{to:{name:"UserProfile",params:{id:t.location.user.id}}}},[s("p",{staticClass:"title font-weight-bold py-0 my-0 user-name-route"},[t._v(" "+t._s(t.location.user.name)+" ")])]),s("p",{staticClass:"subtitle-2 py-0 my-0"},[s("span",{staticClass:"grey--text"},[t._v("Response rating: ")]),s("span",[t._v("Excellent")])]),s("p",{staticClass:"subtitle-2 py-0 my-0"},[s("span",{staticClass:"grey--text"},[t._v("Response time: ")]),s("span",[t._v("A few hours")])])],1),s("v-col",{staticClass:"text-right"},[s("router-link",{staticStyle:{"text-decoration":"none",color:"black"},attrs:{to:{name:"UserProfile",params:{id:t.location.user.id}}}},[s("user-avatar",{attrs:{image:t.location.user.avatar,size:64}})],1)],1)],1)],1)],1),s("v-divider"),s("div")],1)},l=[],u={components:{UserAvatar:o.Z},props:{location:{required:!0,type:Object,default:function(){return{images:[],user:{}}}}}},d=u,h=s(1001),p=s(43453),g=s.n(p),f=s(53237),m=s(82102),v=s(11418),b=s(97047),w=s(62877),x=(0,h.Z)(d,c,l,!1,null,"5069c7f9",null),y=x.exports;g()(x,{VCard:f.Z,VCol:m.Z,VDivider:v.Z,VImg:b.Z,VRow:w.Z});var Z=s(80394),C={components:{UserAvatar:o.Z,LocationDetails:y},data:function(){return{threads:[],selectedThread:{},loading:!1,messages:[],newMessages:[],msg:null,messagesSoundURL:"https://proxy.notificationsounds.com/notification-sounds/elegant-notification-sound/download/file-sounds-1233-elegant.mp3"}},computed:{location:function(){return this.selectedThread.location}},created:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.loadUserThreads();case 2:t.threads.length>0&&(t.selectedThread=t.threads[0],t.$router.replace({name:"Messages.Thread",params:{id:t.threads[0].id}})),Z.c.$on("new-messenger-message",t.setNewMessage);case 4:case"end":return e.stop()}}),e)})))()},methods:{setNewMessage:function(t){this.selectedThread&&this.selectedThread.id!=t.thread_id&&this.newMessages.push(t),Z.c.$emit("message-for-thread-"+t.thread_id,t),this.playMessagesSound()},playMessagesSound:function(){var t=new Audio(this.messagesSoundURL);t.play()},countThreadNewMessages:function(t){for(var e=0,s=0;s<this.newMessages.length;s++)this.newMessages[s].thread_id==t&&++e;return e},removeThreadNewMessages:function(t){for(var e=0;e<this.newMessages.length;e++)this.newMessages[e].thread_id==t&&this.newMessages.splice(e,1)},setSelectedThread:function(t){this.selectedThread=t},getThreadUser:function(t){return t.participants[0].user_id==this.$store.getters["User/user"].id?t.participants[1].user:t.participants[0].user},loadUserThreads:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,(0,n.vW)();case 3:s=e.sent,t.threads=s.data,t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()}}},_=C,S=s(13099),k=s(37118),R=s(99846),T=s(16816),V=s(97620),$=s(96421),M=s(41317),B=s(57003),L=s(99762),U=(0,h.Z)(_,a,r,!1,null,"3776e39b",null),P=U.exports;g()(U,{VBadge:S.Z,VCard:f.Z,VCardTitle:k.EB,VCol:m.Z,VContainer:R.Z,VDivider:v.Z,VList:T.Z,VListItem:V.Z,VListItemAvatar:$.Z,VListItemContent:M.km,VListItemSubtitle:M.oZ,VListItemTitle:M.V9,VProgressLinear:B.Z,VRow:w.Z,VSpacer:L.Z})}}]);
//# sourceMappingURL=messages-index-legacy.a4894e3d.js.map